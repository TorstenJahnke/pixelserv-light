[version]
4.36.0.1

[directories]
ca-dir=/etc/tlsgateNG/ca

[prime]
path=/etc/tlsgateNG/primes

[keypool]
path=/etc/tlsgateNG/bundles

[backup]
path=/etc/tlsgateNG/backup

[legacy]
legacy-crypto=false
default-domain=default.local

[certificate]
enable-wildcards=true
enable-san=true
validity-days=200
cache-certificates=true
# Second-Level TLDs: *.co.uk statt *.uk (Format: .co.uk pro Zeile)
second-level-tld-file=/etc/tlsgateNG/second-level-tlds.conf

[html]
any-responses=false
html-path=/etc/tlsgateNG/block.html

# Silent Blocker: /etc/tlsgateNG/silent-blocks.conf
# Format: domain path-pattern delay(ms) status
# Beispiel: google-analytics.com /(*)/(*) 0 204

[server]
listen-address=127.0.0.1
http-port=80
https-port=443
auto-port=0
workers=4
max-connections=10000

# [runtime] - DropRoot Konfiguration
# Nach dem Start wechselt der Prozess zu einem unprivilegierten Benutzer.
# Dies ist wichtig für die Sicherheit - ein kompromittierter Prozess hat nur
# eingeschränkte Rechte.
#
# Ablauf:
#   1. Start als root (um Ports <1024 zu binden)
#   2. CA-Keys laden (nur root kann /etc/tlsgateNG/ca lesen)
#   3. Log-Verzeichnisse erstellen und Berechtigungen setzen
#   4. DropRoot: Wechsel zu user:group
#   5. Prozess läuft als unprivilegierter Benutzer
#
# Installation:
#   useradd --system --no-create-home --shell /usr/sbin/nologin tlsgate
#   groupadd --system tlsgate
#
[runtime]
daemonize=false
verbose=false
user=tlsgate
group=tlsgate

[pool]
pool-size=500
use-shm=false
certcache-capacity=1M
force-algorithm=ECDSA-P256
rsa-3072-percent=30
ecdsa-p256-percent=60
sm2-percent=10

# [index] master wird automatisch aus use-shm abgeleitet:
#   use-shm=false → master=true  (Standalone)
#   use-shm=true  → master=false (Worker)

[framework-logging]
enabled=true
log-path=/var/log/tlsgateNG/framework
log-file-size=50M
log-total-size=1G
log-max-files=20

[ca-RSA]
sub-cert-path=/etc/tlsgateNG/ca/RSA/subca.crt
sub-key-path=/etc/tlsgateNG/ca/RSA/subca.key
root-cert-path=/etc/tlsgateNG/ca/RSA/rootca.crt

[ca-ECDSA]
sub-cert-path=/etc/tlsgateNG/ca/ECDSA/subca.crt
sub-key-path=/etc/tlsgateNG/ca/ECDSA/subca.key
root-cert-path=/etc/tlsgateNG/ca/ECDSA/rootca.crt

[ca-SM2]
sub-cert-path=/etc/tlsgateNG/ca/SM2/subca.crt
sub-key-path=/etc/tlsgateNG/ca/SM2/subca.key
root-cert-path=/etc/tlsgateNG/ca/SM2/rootca.crt

[ca-LEGACY]
sub-cert-path=/etc/tlsgateNG/ca/LEGACY/subca.crt
sub-key-path=/etc/tlsgateNG/ca/LEGACY/subca.key
root-cert-path=/etc/tlsgateNG/ca/LEGACY/rootca.crt

[license]
key=XXXX-XXXX-XXXX-XXXX
